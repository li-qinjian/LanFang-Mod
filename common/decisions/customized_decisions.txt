lan_move_capital_to_malaya = {
	is_shown = {
		c:LAN ?= ROOT
		#NOT = { has_variable = moved_capital_to_malaya }
		NOT = {
			capital = { state_region = s:STATE_MALAYA }
		}
	}

	possible = {
		c:LAN ?= ROOT
		owns_entire_state_region = STATE_MALAYA
	}

	when_taken = {
		#set_variable = moved_capital_to_malaya
		set_capital = STATE_MALAYA
		set_state_type = incorporated
	}

	ai_chance = {
		value = 0
	}
}

lan_move_chinese_to_capital = {
	is_shown = {
		c:LAN ?= ROOT
			any_scope_state = {
			is_incorporated = no
			is_split_state = yes
			any_scope_pop = {
				culture = {
					has_discrimination_trait = heritage_han
				}
			}
		}
	}

	possible = {
		c:LAN ?= ROOT
		any_scope_state = {
			is_incorporated = no
			is_split_state = yes
			any_scope_pop = {
				culture = {
					has_discrimination_trait = heritage_han
				}
			}
		}
	}

	when_taken = {
		every_scope_state = {
			limit = {
				is_incorporated = no
				is_split_state = yes
			}
			every_scope_pop = {
				limit = {
					culture = {
						has_discrimination_trait = heritage_han
					}
				}
				custom_tooltip = {
					text = move_chineses_tt
					move_pop = root.capital
				}
			}
		}
	}

	ai_chance = {
		value = 0
	}
}

ban_opium = {
	is_shown = {
		is_player = yes
		exists = market
		market.owner = root
		NOT = { is_banning_goods = g:opium }
	}

	possible = {
		is_player = yes
		NOT = { has_law_or_variant = law_type:law_free_trade }
		exists = market
		any_primary_culture = {
			has_discrimination_trait = heritage_han
		}
	}

	when_taken = {
		#add_banned_goods = g:opium
		c:DEI = {
			random_subject_or_below = {
				limit = { 
					is_subject_type = subject_type_puppet
					liberty_desire < 25
					num_states <= 1
					any_scope_state = {
						is_split_state = yes
					}
				}
				save_scope_as = dei_annexation_target
			}
			if = {
				limit = { exists = scope:dei_annexation_target }
				create_diplomatic_play = {
					name = dp_annex_subject
					target_country = scope:dei_annexation_target
					type = dp_annex_subject
				}
			}
		}
	}

    ai_chance = {
		value = 0
    }
}

move_capital_from_split_state = {
	is_shown = {
		is_player = yes
		capital = {
			is_split_state = yes
		}
	}

	possible = {
		c:LAN ?= ROOT
		owns_entire_state_region = STATE_NORTH_BORNEO
	}

	when_taken = {
		set_capital = STATE_NORTH_BORNEO
		
		capital = {
			set_state_type = incorporated
		}
	}

	ai_chance = {
		value = 0
	}
}

trigger_prussia_danish_war = {
	is_shown = {
		is_player = yes
		#game_date >= 1848.1.1
	}

	possible = {
		exists = c:PRU
		exists = c:DEN
		exists = c:AUS
		c:PRU = {
			is_at_war = no
			NOT = {
				has_diplomatic_pact = {
					who = c:DEN
					type = alliance
				}
			}
		}
		c:DEN = {
			is_at_war = no
		}
	}

	when_taken = {
		c:PRU = {
			create_diplomatic_play = {
				name = liberate_subject
				target_country = c:SCH
				type = dp_liberate_subject
				
				add_initiator_backers = { c:AUS }
				
				add_war_goal = {
					holder = c:PRU
					type = annex_country
					target_country = c:HOL
				}
			}
		}
		
		if = {
			limit = {
				exists = c:AUS
				c:AUS = {
					has_diplomatic_pact = {
						who = c:PRU
						type = military_access
					}
				}
			}
			random_diplomatic_play = {
				limit = {
					#target = { c:DEN ?= this }
					initiator = { c:PRU ?= this }
				}
				add_initiator_backers = { c:HAN }
			}
		}
	}

	ai_chance = {
		value = 0
	}
}